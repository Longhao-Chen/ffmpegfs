<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FFmpegfs Fuse Multi Media Filesystem: Installation Instructions for FFmpegfs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FFmpegfs Fuse Multi Media Filesystem
   &#160;<span id="projectnumber">1.99</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Installation Instructions for FFmpegfs </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md22"></a>
Installation from repository</h1>
<h2><a class="anchor" id="autotoc_md23"></a>
Debian Buster</h2>
<p>FFmpegfs 1.10 can be installed on Debian 10 Buster from Buster Backports and sid (which is not recommended and therefore not described here).</p>
<p>To enable Buster Backports: </p><pre class="fragment"> echo "deb http://deb.debian.org/debian buster-backports main" | sudo tee /etc/apt/sources.list.d/backports.list

 sudo apt-get update
</pre><p>Then install FFmpegfs: </p><pre class="fragment"> sudo apt-get -t buster-backports install ffmpegfs
</pre><h2><a class="anchor" id="autotoc_md24"></a>
Debian Bullseye</h2>
<p>FFmpegfs 1.10 has been added to Debian 11 Bullseye so it is available as binary distribution.</p>
<p>On Debian 11 Bullseye you can simply do </p><pre class="fragment">apt-get install ffmpegfs
</pre><p>For Ubuntu 20.04 and Linux distributions based on it this is </p><pre class="fragment">apt install ffmpegfs
</pre><h2><a class="anchor" id="autotoc_md25"></a>
Other Distributions</h2>
<p>For Arch Linux and Manjaro, it can be found in the Arch User Repository (AUR). It is available as either the latest stable version or the latest code from GIT.</p>
<h1><a class="anchor" id="autotoc_md26"></a>
Building FFmpegfs yourself</h1>
<h2><a class="anchor" id="autotoc_md27"></a>
Prerequisites</h2>
<p>FFmpegfs uses FFmpeg lib for decoding/encoding. It requires the following libraries:</p>
<ul>
<li>gcc and g++ compilers</li>
<li>fuse (&gt;= 2.6.0)</li>
<li>sqlite3 (&gt;= 3.7.13)</li>
<li>libavutil (&gt;= 54.3.0)</li>
<li>libavcodec (&gt;= 56.1.0)</li>
<li>libavformat (&gt;= 56.1.0)</li>
<li>libavfilter (&gt;= 5.40.0)</li>
<li>libswscale (&gt;= 3.0.0)</li>
</ul>
<p>One of these is required, preferably libswresample as libavresample is deprecated. It will be removed some day from FFmpeg API.</p>
<ul>
<li>libswresample (&gt;= 1.0.0)</li>
<li>libavresample (&gt;= 2.1.0)</li>
</ul>
<p>For optional DVD support you need the following libraries</p>
<ul>
<li>libdvdread (&gt;= 5.0.0)</li>
<li>libdvdnav (&gt;= 5.0.0)</li>
</ul>
<p>For optional Bluray support you need the following library</p>
<ul>
<li>libbluray (&gt;= 0.6.2)</li>
</ul>
<p>The commands to install just the first prerequisites follow.</p>
<p>Please read the "Supported Linux Distributions" chapter in README.md for details.</p>
<p><b>On Debian:</b> </p><pre class="fragment">apt-get install gcc g++ make pkg-config asciidoc-base w3m

apt-get install fuse libfuse-dev libsqlite3-dev libavcodec-dev libavformat-dev libswresample-dev libavutil-dev libswscale-dev libavfilter-dev
</pre><p>To get DVD support: </p><pre class="fragment">apt-get install libdvdread-dev libdvdnav-dev
</pre><p>To get Bluray support: </p><pre class="fragment">apt-get install libbluray-dev
</pre><p>To "make doxy" (build Doxygen documentation): </p><pre class="fragment">apt-get install doxygen graphviz curl
</pre><p>To "make check" (run test suite): </p><pre class="fragment">apt-get install libchromaprint-dev bc
</pre><p><b>On Suse</b> (please read notes before continuing): </p><pre class="fragment">zypper install gcc gcc-c++

zypper install fuse fuse-devel libsqlite3-devel libavcodec-devel libavformat-devel libswresample-devel libavutil-devel libswscale-devel
</pre><p>To get DVD support: </p><pre class="fragment">zypper install libdvdread-devel libdvdnav-devel
</pre><p>To get Bluray support: </p><pre class="fragment">zypper install libbluray-devel
</pre><p>Suse includes non-proprietary codecs with FFmpeg only, namely mp3, AAC and H264 are <em>not</em> available which renders this library next to usesless. But FFmpeg can be built from source, see <a href="https://trac.ffmpeg.org/wiki/CompilationGuide">https://trac.ffmpeg.org/wiki/CompilationGuide</a> and check "FFmpeg compile notes" below.</p>
<p><b>On Red Hat:</b> </p><pre class="fragment">yum install gcc g++

yum install fuse-devel sqlite-devel
</pre><p>To get DVD support: </p><pre class="fragment">yum install libdvdread-devel libdvdnav-devel
</pre><p>To get Bluray support: </p><pre class="fragment">yum install libbluray-devel
</pre><p>Red Hat does not provide FFmpeg from its repositories. It must be built from source code, see this guide: <a href="https://trac.ffmpeg.org/wiki/CompilationGuide/Centos">https://trac.ffmpeg.org/wiki/CompilationGuide/Centos</a></p>
<p>If you want to build the documentation you will find "asciidoc" missing from the Red Hat repositories. To get it use a beta repository: </p><pre class="fragment">yum --enablerepo=rhel-7-server-optional-beta-rpms install asciidoc
</pre><p><b>On Funtoo Linux:</b></p>
<p>To get fuse suppprt and chromaprint (for make check): </p><pre class="fragment">emerge sys-fs/fuse
emerge media-libs/chromaprint
</pre><p>To get FFmpeg with H264 etc. support, specify some "USE flags" when doing emerge:</p>
<p>Create file /etc/portage/package.use, e.g. "vi vi /etc/portage/package.use" and add this line: </p><pre class="fragment">media-video/ffmpeg mp3 x264 opus vorbis vpx
</pre><p>This will enable H264, mp3, Opus and WebM support. Next... </p><pre class="fragment">emerge media-libs/openh264
emerge media-sound/twolame

emerge media-video/ffmpeg
</pre><p>to build ffmpeg.</p>
<p>FFmpeg compile notes:</p>
<p>FFmpeg must be built with at least libx264, libfdk_aac and libmp3lame support. Other libraries, e.g. ogg, Windows Media or FLAC must be added when these formats should be used as source.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Building source code</h2>
<p>Download a release archive: </p><pre class="fragment">wget https://github.com/nschlia/ffmpegfs/releases/download/v1.98/ffmpegfs-1.98.tar.gz
</pre><p>You may check <a href="https://github.com/nschlia/ffmpegfs/releases">https://github.com/nschlia/ffmpegfs/releases</a> to see if there are newer releases available.</p>
<p>Then unpack and cd to the source directory. To build and install, run: </p><pre class="fragment">./configure
make
make install
</pre><p>To build and run the check suite, do: </p><pre class="fragment">make checks
</pre><p>This will test audio conversion, tagging and size prediction.</p>
<p>NOTE: Image embedding is not yet implemented. The test has been disabled at the moment.</p>
<h2><a class="anchor" id="autotoc_md29"></a>
Building from GIT</h2>
<p>If you want to build FFmpegfs yourself, e.g. check out the latest version from GIT and be at the bleeding edge:</p>
<p><b>If building from git, you'll need these additional prerequisites:</b></p>
<ul>
<li>autoconf</li>
<li>automake</li>
<li>asciidoc (or at least asciidoc-base to save disk space)</li>
<li>w3m</li>
</ul>
<p>For those who are lazy like me, simply copy and issue this command to get all prerequisites: </p><pre class="fragment">apt-get install gcc g++ make pkg-config autoconf asciidoc-base w3m libchromaprint-dev bc doxygen graphviz
</pre><p>FFmpegfs uses the GNU build system, so you'll need to run first: </p><pre class="fragment">./autogen.sh
</pre><p>If you are downloading a release, this has already been done for you. To build and install, run: </p><pre class="fragment">./configure
make
make install
</pre><p>To build and run the check suite, do: </p><pre class="fragment">make checks
</pre><h2><a class="anchor" id="autotoc_md30"></a>
Documentation</h2>
<p>The help can be created in doc or html format by running </p><pre class="fragment">make help-pdf
make help-html
</pre><p>respectively.</p>
<h2><a class="anchor" id="autotoc_md31"></a>
Trouble Shooting</h2>
<p><b>Mounting via /etc/fstab fails:</b></p>
<p>An fstab line with fuse.ffmpegfs file system fails with a strange message when attempted to mount with "mount -av". No log entries, no other hints...</p>
<p>mount: wrong fs type, bad option, bad superblock on /mnt/sdf1/mp3base1, missing codepage or helper program, or other error</p>
<p>In some cases useful info is found in syslog - try dmesg | tail or so.</p>
<p>Fuse is missing! Do... </p><pre class="fragment">apt-get install fuse
</pre><p><b>fuse: failed to exec fusermount: No such file or directory:</b></p>
<p>Trying to mount as other than root, the message </p><pre class="fragment">fuse: failed to exec fusermount: No such file or directory
</pre><p>is printed.</p>
<p>Fuse is missing! Do... </p><pre class="fragment">apt-get install fuse
</pre><p>**"ERROR: libmp3lame &gt;= 3.98.3 not found":**</p>
<p>If you run into this "ERROR: libmp3lame &gt;= 3.98.3 not found" although you have built and installed libmp3lame you may find a solution here: <a href="https://stackoverflow.com/questions/35937403/error-libmp3lame-3-98-3-not-found">https://stackoverflow.com/questions/35937403/error-libmp3lame-3-98-3-not-found</a></p>
<p><b>autogen.sh displays "possibly undefined macro":</b> </p><pre class="fragment">Running autoreconf --install
configure.ac:46: error: possibly undefined macro: AC_DEFINE
  If this token and others are legitimate, please use m4_pattern_allow.
  See the Autoconf documentation.
autoreconf: /usr/bin/autoconf failed with exit status: 1
</pre><p>You are probably missing out on pkg-config, either it is not installed or not in path. "apt-get install pkg-config" (on Debian or equivalent on other Linux distributions) should help.</p>
<p><b>If the videotag.php script does not work under PHP7</b></p>
<p>The script runs fine under PHP5, but when upgrading to PHP7 (or using PHP7) it suddenly stops showing the list of files.</p>
<p>Check the Apache2 error.log, you might see this:</p>
<p>"PHP Fatal error:  Uncaught Error: Call to undefined function utf8_encode() in index.php"</p>
<p>This is because for some reason utf8_encode() has been moved to the XML library. Just do (or similar): </p><pre class="fragment">apt-get install php7.0-xml
systemctl restart apache2
</pre><p>And your troubles should be gone.</p>
<p>**"make check": all audio checks fail**</p>
<p>Logfiles contain "bc: command not found", so the command line communicator is missing.</p>
<p>Fix by installing it (or similar): </p><pre class="fragment"> apt-get install bc
</pre><p><b>Songs get cut short</b></p>
<p>If songs do not play to the very end and you are using SAMBA or NFS you're in trouble.</p>
<p>Happens when the files are transcoded on the fly, but never when file comes from cache. This is because the result is never exactly what was predicted.</p>
<p>SAMBA fills files with zeroes if the result is smaller, or cuts off the rest if the file ist larger than predicted.</p>
<p>NFS arbitrarily sends the correct file, or one that is cut or padded like SAMBA. This can be repeated as many times as one wants to - once the file is OK, once not.</p>
<p>As of yet there seems to be no way around that. Maybe NFS or SAMBA can be configured to cope with that, but how to is unknown to me.</p>
<p><b>Make reports "/bin/sh: a2x: command not found"</b></p>
<p>You are missing out on asciidoc, to install do (or similar): </p><pre class="fragment"> apt-get install asciidoc
</pre><p>That should fix it. You may just install asciidoc-base to safe disk space.</p>
<p><b>libbluray fails to load libbluray.jar</b></p>
<p>When you see this message accessing blurays: </p><pre class="fragment">bdj.c:340: libbluray-j2se-0.9.3.jar not found.
bdj.c:466: BD-J check: Failed to load libbluray.jar
</pre><p>To get rid of this message simply install "libbluray-bdj", this will make it go away. Though not necessary, as to read the bluray tracks java support is not required, so this is simply cosmetical.</p>
<p><b>Switching between repository version and source builds</b></p>
<p>It is easy to switch between both worlds. You can do that as many times as you want to, alas the cache directory will be cleared every time. But it will be rebuild in the background so this will almost go unnoticed.</p>
<p>To switch from repository to a source build do</p>
<p>apt-get remove ffmpegfs</p>
<p>Then follow the steps under "Building FFmpegfs yourself". If you do not remove the repository version, you self-build could be unadvertedly up- or downgraded when a new version becomes available from the repository.</p>
<p>To switch from a source build to a repository installation change to the build directory and do</p>
<p>make uninstall</p>
<p>Then follow the steps under "Installation from repository".</p>
<h2><a class="anchor" id="autotoc_md32"></a>
COPYRIGHT</h2>
<p>Copyright (C) 2017-2020 Norbert Schlia (<a href="#" onclick="location.href='mai'+'lto:'+'nsc'+'hl'+'ia@'+'ob'+'liv'+'io'+'n-s'+'of'+'twa'+'re'+'.de'; return false;">nschl<span style="display: none;">.nosp@m.</span>ia@o<span style="display: none;">.nosp@m.</span>blivi<span style="display: none;">.nosp@m.</span>on-s<span style="display: none;">.nosp@m.</span>oftwa<span style="display: none;">.nosp@m.</span>re.d<span style="display: none;">.nosp@m.</span>e</a>) This file was originally copyright (C) 2013-2014 K. Henriksson.</p>
<p>This documentation may be distributed under the GNU Free Documentation License (GFDL) 1.3 or later with no invariant sections, or alternatively under the GNU General Public License (GPL) version 3 or later. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
